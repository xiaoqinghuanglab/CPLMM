% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/models_cplmm.R
\name{fit_cplmm_all_proteins}
\alias{fit_cplmm_all_proteins}
\title{Fit change-point LMMs across multiple proteins and strata}
\usage{
fit_cplmm_all_proteins(
  df_status_change,
  df_normal,
  df_abnormal,
  protein_list,
  covariates = c("SEX", "BASELINE_AGE"),
  subject_id_col = "SUBID",
  years_since_onset_col = "years_since_onset"
)
}
\arguments{
\item{df_status_change}{Data frame for status-change subjects.}

\item{df_normal}{Data frame for always-normal subjects.}

\item{df_abnormal}{Data frame for always-abnormal subjects.}

\item{protein_list}{Character vector of protein column names to model.}

\item{covariates}{Character vector of additional fixed-effect covariates.
Defaults to c("SEX","BASELINE_AGE").}

\item{subject_id_col}{Column name for subject ID (random intercept). Default "SUBID".}

\item{years_since_onset_col}{Column name for years since onset. Default "years_since_onset".}
}
\value{
A tibble with one row per protein containing Beta 1â€“4, their SEs,
the status-model intercept, and AIC/BIC/MSE per stratum.
}
\description{
Fits three random-intercept LMMs per protein:
\itemize{
\item Status-change:  protein ~ before_onset + after_onset + covariates + (1 | subject_id)
\item Normal-only:    protein ~ before_onset + covariates + (1 | subject_id)
\item Abnormal-only:  protein ~ after_onset  + covariates + (1 | subject_id)
}
}
\details{
The change point is fixed at 0 on \code{years_since_onset_col}. We define
\code{before_onset = pmax(0, -years_since_onset)} and
\code{after_onset  = pmax(0,  years_since_onset)}.
For interpretability consistent with your Python, the returned
Beta 1 is \code{-coef(before_onset)} (slope wrt years_before_onset),
and Beta 3 is \code{coef(after_onset)}.
}
\examples{
# See tests for a minimal synthetic example.
}
