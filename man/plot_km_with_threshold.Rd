% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/survival_km.R
\name{plot_km_with_threshold}
\alias{plot_km_with_threshold}
\title{KM plot for biomarker threshold crossing (with log-rank and risk table)}
\usage{
plot_km_with_threshold(
  biomarker_name,
  threshold,
  wd_df,
  normal_df,
  abnm_df,
  threshold_dict = NULL,
  save = FALSE,
  save_path = "Figures",
  jama_palette = NULL,
  time_points = seq(-10, 4, by = 2)
)
}
\arguments{
\item{biomarker_name}{Character; biomarker column (e.g. "NFL").}

\item{threshold}{Numeric; threshold for event definition.}

\item{wd_df}{Data frame of Status-Change subjects (must contain SUBID, PROCEDURE_AGE, ONSET_AGE, CATEGORY, biomarker).}

\item{normal_df}{Data frame of Normal-only subjects.}

\item{abnm_df}{Data frame of Abnormal-only subjects (kept for parity; not plotted by default).}

\item{threshold_dict}{Optional; ignored (kept for parity with Python signature).}

\item{save}{Logical; save the combined figure as SVG? Default FALSE.}

\item{save_path}{Directory to save into if \code{save=TRUE}. Default "Figures".}

\item{jama_palette}{Named character vector of colors; names should include
"Status-Change", "Normal", "MCI". Defaults to JAMA-like palette.}

\item{time_points}{Numeric vector of x tick labels (in years to onset) to show.
Default: \code{seq(-10, 4, by = 2)} (matches Python's -10..+4).}
}
\value{
A patchwork/ggplot object with the KM and risk-table stacked.
}
\description{
Builds event data via \code{compute_event_df()} for three groups:
Status-Change (all \code{wd_df}), Normal-only (\code{normal_df}), and MCI
(subset of \code{wd_df} where \code{CATEGORY == "MCI"}). Fits KM curves,
draws a vertical line at onset (0), annotates the Normal vs MCI log-rank
p-value, and shows an at-risk table. Internally, times are shifted so they're
non-negative (required by \pkg{survival}), but the x-axis shows the original
requested time points.
}
