% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stats_wald.R
\name{compute_wald_test}
\alias{compute_wald_test}
\title{Wald tests for pre- vs post-onset slope differences}
\usage{
compute_wald_test(results_df, adjust_p = TRUE, rank_by = 1, alpha = 0.05)
}
\arguments{
\item{results_df}{A data.frame/tibble from \code{fit_cplmm_all_proteins()}
containing columns: \code{Protein}, \code{Beta 1}, \code{SE Beta 1},
\code{Beta 2}, \code{SE Beta 2}, \code{Beta 3}, \code{SE Beta 3},
\code{Beta 4}, \code{SE Beta 4}.}

\item{adjust_p}{Logical; apply BH-FDR? Default \code{TRUE}.}

\item{rank_by}{Integer {1,2}; rank by test 1 (status-change slopes) or test 2
(normal vs abnormal slopes). Default \code{1}.}

\item{alpha}{Numeric; significance threshold. Default \code{0.05}.}
}
\value{
A tibble with columns:
\itemize{
\item \code{Protein}
\item \code{Beta 1}, \code{SE Beta 1}, \code{Beta 3}, \code{SE Beta 3},
\code{Wald Statistic 1}, \code{P-value 1}, and (if adjusted)
\code{Adjusted P-value 1}, \code{Significant 1}
\item \code{Beta 2}, \code{SE Beta 2}, \code{Beta 4}, \code{SE Beta 4},
\code{Wald Statistic 2}, \code{P-value 2}, and (if adjusted)
\code{Adjusted P-value 2}, \code{Significant 2}
\item \code{Rank} (1 = most significant according to \code{rank_by})
}
}
\description{
Compares (Beta 1 vs Beta 3) and (Beta 2 vs Beta 4) using 1-df Wald tests:
\deqn{W = (b_i - b_j)^2 / (se_i^2 + se_j^2),\quad p = 1 - F_{\chi^2_1}(W).}
Optionally applies BH-FDR to each set of p-values, ranks results by the chosen
(adjusted) p-value, and flags significance at \code{alpha}.
}
