% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stats_mannwhitney.R
\name{compare_groups_mannwhitney}
\alias{compare_groups_mannwhitney}
\title{Mann–Whitney (Wilcoxon rank-sum) comparison for two groups across genes}
\usage{
compare_groups_mannwhitney(
  combined_expr,
  gene_list,
  group1,
  group2,
  alpha = 0.05,
  rank_by = "FDR"
)
}
\arguments{
\item{combined_expr}{A data.frame/tibble with columns \code{Gene}, \code{Expression}, \code{Source}.}

\item{gene_list}{Character vector of gene/protein names to test.}

\item{group1}{Character; label of the first group in \code{Source}.}

\item{group2}{Character; label of the second group in \code{Source}.}

\item{alpha}{Numeric; FDR threshold for \code{Significant}. Default 0.05.}

\item{rank_by}{Character; one of \code{"FDR"}, \code{"p_value"}, or \code{"Delta_mean"}.
Sorting is ascending for p/FDR, descending for Delta_mean (mirrors Python).}
}
\value{
A tibble with columns:
\code{Gene}, \verb{<group1>_mean}, \verb{<group2>_mean}, \code{Delta_mean},
\code{U_statistic}, \code{p_value}, \code{FDR}, \code{Significant}, and sorted by \code{rank_by}.
}
\description{
Given a long-format expression table with columns \code{Gene}, \code{Expression}, \code{Source},
performs a two-sided Wilcoxon rank-sum test (aka Mann–Whitney U) for each gene
comparing \code{group2} vs \code{group1}. It reports group means, their difference
(\code{Delta_mean = mean(group2) - mean(group1)}), test statistic, raw p-value,
BH/FDR-adjusted p-value, and a significance flag at \code{alpha}.
}
